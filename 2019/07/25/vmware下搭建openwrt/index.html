<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>vmware下搭建openwrt | Tw0Fly</title><meta name="description" content="vmware下搭建openwrt"><meta name="keywords" content="安装文档"><meta name="author" content="tomcat"><meta name="copyright" content="tomcat"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="canonical" href="https://github.com/Tw0Fly/Tw0Fly.github.io/2019/07/25/vmware下搭建openwrt/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="vmware下搭建openwrt"><meta name="twitter:description" content="vmware下搭建openwrt"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/Photo/avatar.png"><meta property="og:type" content="article"><meta property="og:title" content="vmware下搭建openwrt"><meta property="og:url" content="https://github.com/Tw0Fly/Tw0Fly.github.io/2019/07/25/vmware下搭建openwrt/"><meta property="og:site_name" content="Tw0Fly"><meta property="og:description" content="vmware下搭建openwrt"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/Photo/avatar.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="next" title="Linux安装ngx_lua_waf实现waf功能" href="https://github.com/Tw0Fly/Tw0Fly.github.io/2019/07/22/Linux安装ngx_lua_waf实现waf功能/"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"cookieDomain":"https://jerryc.me/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    title: 'Bookmark',
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days'

  
}</script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-首先官网下载已有的系统image。"><span class="toc-number">1.</span> <span class="toc-text">1.首先官网下载已有的系统image。</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-开始搭建openwrt环境。"><span class="toc-number">2.</span> <span class="toc-text">2.开始搭建openwrt环境。</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-修改配置文件。"><span class="toc-number">3.</span> <span class="toc-text">3.修改配置文件。</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-修改虚拟机ip。"><span class="toc-number">4.</span> <span class="toc-text">4.修改虚拟机ip。</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-浏览器访问。"><span class="toc-number">5.</span> <span class="toc-text">5.浏览器访问。</span></a></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/Photo/post.png)"><div id="page-header"><span class="pull-left"> <a class="blog_title" id="site-name" href="/">Tw0Fly</a></span><div class="open toggle-menu pull-right"><div class="menu-icon-first"></div><div class="menu-icon-second"></div><div class="menu-icon-third"></div></div><span class="pull-right menus"><div class="mobile_author_icon"><img class="lozad" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/Photo/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'"><div class="mobile_author-info__description">VX:15833212623</div></div><hr><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a><script>document.body.addEventListener('touchstart', function(){ });</script></div></span><span class="pull-right"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> Search</span></a></span></div><div id="post-info"><div id="post-title"><div class="posttitle">vmware下搭建openwrt</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> Created 2019-07-25<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> Updated 2019-09-19</time></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><p>本次搭建并非是源码安装，因为那样太费时了。</p>
<h2 id="1-首先官网下载已有的系统image。"><a href="#1-首先官网下载已有的系统image。" class="headerlink" title="1.首先官网下载已有的系统image。"></a>1.首先官网下载已有的系统image。</h2><p>网址如下： <a href="https://archive.openwrt.org/chaos_calmer/15.05.1/x86/generic/" target="_blank" rel="noopener">https://archive.openwrt.org/chaos_calmer/15.05.1/x86/generic/</a>。<br>进入网页后，找到combined-ext4.img.gz，并将其下载下来，然后解压，得到一个.img的文件。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/dde6a94b36757cd2c4e01e467a1a159f-50655" alt><br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/c055d31dc6d77e8673d54784123be03c-36315" alt><br> 由于.img的文件不能直接被vmware使用，需要使用qemu-img工具进行转换，转换为vmdk格式的文件。<br>Ubuntu系统下直接执行：<br><code>apt-get install -y qemu-utils</code><br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/41f772487a36712daebc5398a3cd9d3c-22736" alt><br> 安装完成之后使用下面命令生成.vmdk格式的文件：<br><code>sudo qemu-img convert -f raw openwrt-15.05.1-x86-generic-combined-ext4.img -O vmdk openwrt-15.05.1-x86-generic-combined-ext4.vmdk</code><br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/27b6d2cf831db82c6ec54be573adef01-27910" alt><br> OK，前期准备已经完成。</p>
<h2 id="2-开始搭建openwrt环境。"><a href="#2-开始搭建openwrt环境。" class="headerlink" title="2.开始搭建openwrt环境。"></a>2.开始搭建openwrt环境。</h2><p>（1）打开vmware，点击新建一个虚拟机。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/04ca6ae3d69ba6052c15c9bb0495e8d1-15117" alt><br>（2）选择自定义（高级）。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/477a6dc0c2c47c14d1062c02f438b8cd-26739" alt><br>（3）选择工作站12.x的兼容性。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/ca8bd0410f1e2624100c6a2889cb1009-22161" alt><br> （4）选择稍后安装操作系统（S）。<br>先创建一个空白的硬盘。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/d47d3279603dfd54683890dad9356d6d-18734" alt><br>（5）这里操作系统选择Linux，版本选择其他Linux 3.x 内核。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/8005fb926db92178384e0af464527dcb-15060" alt><br>（6）虚拟机名称随意，这里我写的是openwrt-15.05.<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/735ad4cf6798fc777977975b9cb060ca-14434" alt><br>（7）处理器配置默认就可以了，直接下一步。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/8fa9754ab8fe37e7ced6b0c14ceff3ad-12448" alt><br>（8）虚拟机内存也是默认的，直接下一步。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/243cd9a38713ba651a9ebd49f83c3d81-18452" alt><br>（9）网络类型选择桥接模式。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/3940f0726e880c12113992be2c90b6e5-18707" alt><br>（10）I/O控制器类型也是默认的，直接下一步。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/0bf83c6a7fc61520b17b0a38b1a0ae66-14702" alt><br>（11）选择磁盘的类型，这里就需要注意了。一定要选择IDE，不然后面是找不到分区的。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/c30fb3d2b490c5e247360d9fe477fc60-14662" alt><br>（12）继续下一步，选择创建新虚拟磁盘。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/ef737ef05f64506bfb4af2b892b37d92-18367" alt><br>（13）磁盘容量默认不变，直接下一步。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/67d676e31402f981d05150edced0638f-19835" alt><br>（14）直接下一步，不用修改文件名。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/1fbb932c1015cfc89c11bec3943eda76-13759" alt><br>（15）点击自定义配件。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/0e9457478d85d9d7ed626d50bd183f6a-18617" alt><br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/590dc991a59726402744dffd1e0233a0-20130" alt><br> 注意这里红框的东西，不要移除错了，除了红框内的硬件以外的硬件全部移除。<br> <img src="https://app.yinxiang.com/FileSharing.action?hash=1/0b0315aa1b6160a99c8ba43c2f8a704f-16302" alt><br>  如上图所示，修改完成之后，点击关闭，然后点击完成。<br>（16）如下图所示，虚拟机已经创建成功了。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/7474582085080ca14ab9a9ae9211afa3-27115" alt></p>
<h2 id="3-修改配置文件。"><a href="#3-修改配置文件。" class="headerlink" title="3.修改配置文件。"></a>3.修改配置文件。</h2><p>但是这个时候不要急着去开启这个虚拟机。先把前面使用qemu-img工具转换得到的openwrt-15.05.1-x86-generic-combined-ext4.vmdk 文件拷贝到刚创建的openwrt虚拟机工作目录下：<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/f5dab5ed556a64fd01ac37ce5d57ef59-26973" alt><br>拷贝到该目录下之后，编辑该虚拟机的配置文件openwrt-15.05.vmx<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/0cb0f5aa3b626def27069e13ef51ee43-25764" alt><br> 打开编辑器，修改：<br>把ide1:0.fileName = “openwrt-15.05.vmdk”修改为ide1:0.fileName = “ openwrt-15.05.1-x86-generic-combined-ext4.vmdk”<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/9640e556e12fe1bc798c3195eb52a17e-40904" alt><br>修改后：<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/9a7215cb5d2174c0d829e0d30a60f8d4-27317" alt><br>然后保存并退出，配置完毕，启动openwrt这台虚拟机。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/1bca915dcaa458c35628cfd5b7d79ab8-16926" alt><br> 这样就启动成功了！</p>
<h2 id="4-修改虚拟机ip。"><a href="#4-修改虚拟机ip。" class="headerlink" title="4.修改虚拟机ip。"></a>4.修改虚拟机ip。</h2><p>修改/etc/config/network文件：<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/1df6f358162df4c7e16008e8613876a5-11236" alt><br>将红框内的ip改为与你主机同网段的ip。我的主机为192.168.43.173，所以我就随便改为了192.168.43.158。如下图所示：<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/9f207801b30a49d91ff3907b0170c005-10263" alt><br> 然后保存并退出。<br>然后执行/etc/init.d/network restart命令，重启一下网络。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/c6c55119c2d23604257fc8a4cbde951a-13999" alt><br>这时候使用自己的主机，ping一下这个ip。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/4f35e08ca93bda85d3f61aa4936f545f-18006" alt><br> 发现此时192.168.43.158是可以ping通的。</p>
<h2 id="5-浏览器访问。"><a href="#5-浏览器访问。" class="headerlink" title="5.浏览器访问。"></a>5.浏览器访问。</h2><p>现在打开浏览器，输入192.168.43.158，可以看到正常访问了。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/119a35bbf3fe091b590606dd8ad4f940-42319" alt><br>点击login，会提示你设置密码。<br><img src="https://app.yinxiang.com/FileSharing.action?hash=1/571676d74b24031624f22711fee8e86d-42026" alt><br> 设置完密码后，点击保存并应用。<br> <img src="https://app.yinxiang.com/FileSharing.action?hash=1/b117b0cd86e062c40a681c57a1567055-7011" alt><br> 然后使用root和刚才设置的密码进行登录，就可以看到真正的openwrt的界面了。如下图所示：<br> <img src="https://app.yinxiang.com/FileSharing.action?hash=1/b5b54ea56eb8efa2b1fa06dfcf08a101-46342" alt><br>  收工！到这openwrt就搭建完成了。</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">tomcat</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://github.com/Tw0Fly/Tw0Fly.github.io/2019/07/25/vmware下搭建openwrt/">https://github.com/Tw0Fly/Tw0Fly.github.io/2019/07/25/vmware下搭建openwrt/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/安装文档/">安装文档    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/Photo/avatar.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-buttom"><i class="fa fa-qrcode"></i> Donate<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lozad post-qr-code__img" data-src="/img/wechat.jpg"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lozad post-qr-code__img" data-src="/img/alipay.jpg"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="next-post pull-full"><a href="/2019/07/22/Linux安装ngx_lua_waf实现waf功能/"><img class="next_cover lozad" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">Next Post</div><div class="next_info"><span>Linux安装ngx_lua_waf实现waf功能</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-thumbs-up" aria-hidden="true"></i><span> Recommend</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2019/07/10/CentOS 7源码安装docker/" title="CentOS 7源码安装docker"><img class="relatedPosts_cover lozad" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_title">CentOS 7源码安装docker</div></a></div><div class="relatedPosts_item"><a href="/2019/07/16/Linux下的sniffer工具--Tcpdump/" title="Linux下的sniffer工具--Tcpdump"><img class="relatedPosts_cover lozad" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_title">Linux下的sniffer工具--Tcpdump</div></a></div><div class="relatedPosts_item"><a href="/2019/07/22/Linux安装ngx_lua_waf实现waf功能/" title="Linux安装ngx_lua_waf实现waf功能"><img class="relatedPosts_cover lozad" data-src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/cover/default_bg.png"><div class="relatedPosts_title">Linux安装ngx_lua_waf实现waf功能</div></a></div></div><div class="clear_both"></div></div></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2019 By tomcat</div><div class="framework-info"><span>Driven </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><section class="rightside" id="rightside"><i class="fa fa-book" id="readmode" title="Read Mode"> </i><i class="fa fa-plus" id="font_plus" title="Increase font size"></i><i class="fa fa-minus" id="font_minus" title="Decrease font size"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="Traditional Chinese and Simplified Chinese Conversion">簡</a><i class="fa fa-moon-o nightshift" id="nightshift" title="Dark Mode"></i></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script async src="/js/search/local-search.js"></script><script src="/js/nightshift.js"></script><script id="ribbon" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN@latest/js/piao.js"></script><script src="/js/tw_cn.js"></script><script>translateInitilization()

</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@1.2.2/instantpage.min.js" type="module"></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>